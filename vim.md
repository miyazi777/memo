vim memo
===========================


shortcut(いつでも)
---------------------------
| 機能           | ショートカット | 備考                               |
|----------------|----------------|------------------------------------|
| バックスペース | C-h            | unix系のシェルにあるショートカット |
| リターン       | C-m            | unix系のシェルにあるショートカット |

shortcut(normal mode)
---------------------------
| 機能                               | ショートカット   |
|:-----------------------------------|:-----------------|
| カーソルの単語の検索               | *                |
| カーソル位置の数値のインクリメント | <C-a>            |
| カーソル位置の数値のデクリメント   | <C-x>            |
| ウィンドウ移動                     | <C-w> h, j, k, l |
| 前に変更した場所へカーソルを移動   | g;               |
| カーソルの下の行を行末へ連結する   | <Shift-j>        |
| 単語の最後に移動して入力モード     | ea               |

ウィンドウ操作
---------------------------
| 機能               | コマンド         |
|:-------------------|:-----------------|
| ウィンドウ分割(縦) | :sp              |
| ウィンドウ分割(縦) | :vs              |
| ウィンドウ移動     | <C-w> h, j, k, l |

ファイル操作関連
---------------------------
| 機能                                 | コマンド       |
|:-------------------------------------|:---------------|
| ファイラー起動                       | :e.            |
| ファイルを開く・新規作成             | :e <file-name> |
| カレントディレクトリの確認           | :pwd           |
| カレントディレクトリの移動           | :cd <path>     |
| ローカルなカレントディレクトリの移動 | :lcd <path>    |


mark
---------------------------
| 機能                          | コマンド |
|-------------------------------|----------|
| カーソル位置をマーク名aに保存 | ma       |
| マーク名aの位置に移動         | 'a       |
| マーク一覧表示                | :marks   |

folding(折りたたみ)
---------------------------
* 折りたたみたい範囲を選択してからzf
* 折りたたみ行でスペースで展開

バッファに関するまとめ
---------------------------
| 機能                     | コマンド           |
|:-------------------------|:-------------------|
| ファイルを開く・新規作成 | e <filename>       |
| バッファの一覧表示       | :ls                |
| 指定番号のバッファに移動 | :b <num            |
| 次のバッファに移動       | :bn                |
| 前のバッファに移動       | :bp                |
| 指定番号のバッファに移動 | <buffer-no> ctrl+^ |

タブ
---------------------------
| 機能           | コマンド |
|:---------------|:---------|
| タブ追加       | :tabnew  |
| 次のタブへ移動 | gt       |
| 前のタブへ移動 | gT       |

新しいファイルの作成方法
---------------------------
コマンドモードで以下のように入力すると新しいバッファが作成される。保存するとファイルに保存される。
:e <file-name>



標準のvimgrepの使い方
---------------------------
grepし、結果を一覧表示する。一覧はカーソルキーで移動でき、リターンキーで表示される
```
:vim {pattern} {file} | cw
```

例 currentが含まれているrubyのファイルを再起的に検索し、結果を一覧表示
```
:vim current **/*.rb | cw
```
### その他、grep関係のコマンド

| コマンド | 内容                             |
|----------|----------------------------------|
| :cn      | 次の検索結果に移動               |
| :cp      | 前の検索結果に移動               |
| :cw      | 検索結果を別ウィンドウで一覧表示 |



その他
---------------------------

### インクリメント・デクリメント
カーソルを数字の上に持っていき、C-a、C-x

### 大文字・小文字変換
#### 小文字->大文字
ヴィジュアルモードで文字を囲ってからU

#### 小文字->大文字
ヴィジュアルモードで文字を囲ってからu


### vim起動中に外部プログラムを実行する
```
:! <command>
```

#### 例 時間を確認
```
:!date
```

### .vimrcの再読み込み
```
:source ~/.vimrc
```

### Leaderについて
mac版のvimではデフォルトで\キーがマッピングされている

### コマンド履歴の表示
ノーマルモード時にq:を押す

### 検索履歴の表示
ノーマルモード時にq?を押す


vim-surround
---------------------------

### 使い方

ビジュアルブロックモードで何かを囲った後に
S - <囲いたい文字列>

#### <>で囲いたい場合、
ビジュアルブロックモードで何かを囲った後に
S - >

#### テキストオブジェクトの範囲が拡張されているらしい
例えばysi"とすると単語を囲むことができる

bbb -> "bbb"

[ysw"]はこのような意味
y (yank)
s (surround)  ここがvim-surroundで拡張された部分
i (inner)
" 追加文字列

### よく使いそうなもの
ysiw" "で囲う xxx -> "xxx"
yiw   "で囲われている文字列をヤンク
vi"   "で囲われている文字をビジュアルモードで選択
ds"   "を削除 "xxx" -> xxx
cs"'  "を'に変更  "xxx" -> 'xxx'

#### 補足
cはcs + 変更対象のカッコ + 変更後のカッコでカッコの変更
dはds + 削除対処のカッコ
yはys + カッコで囲う対象のテキストオブジェクト + カッコで囲う


vim-table-mode
---------------------------

## 使い方
### 手順1
<Leader>tm
でテーブルモードに入る・抜ける

* <Leader>はmacでは\キー

### 手順2
以下のような項目タイトルを入力
```
| foo | bar |
```

### 手順3
改行して以下のように打つ
```
||
```

### 手順4
表の中身を入力していくと勝手にいい感じにテーブルレイアウトを調整してくれる
```
| xxx | yyy |
```
| xxx | xxx |


Previm
---------------------------

### install
NeoBundleを使っている場合のインストール方法。
.vimrcに以下の設定を追加。

```
NeoBundle 'tyru/open-browser.vim'
NeoBundle 'kannokanno/previm'

autocmd BufNewFile,BufRead *.{md,mdwn,mkd,mkdn,mark*} set filetype=markdown
```

### 使い方
:Previm
であとは基本的には同期する


NeoBundle
---------------------------

### プラグインの追加方法
1. ~/.vimrcに以下のように記述し、プラグインを追加
    > NeoBundle 'xxxxx/xxxxxx.vim'
2. :source ~/.vimrc
3. :NeoBundleInstall

#### プラグインの追加される先
~/.vim/bundle/


### プラグインの更新方法
:NeoBundleUpdate


previm plugin マークダウンプラグインを導入した際のメモ
---------------------------
### 手順
1. 下記の設定を.vimrcに追記
2. :source ~/.vimrc
3. :NeoBundleInstall

#### .vimrc プラグインの設定
	NeoBundle 'plasticboy/vim-markdown'	" マークダウン用プラグイン
	NeoBundle 'kannokanno/previm'		" マークダウンのプレビュー用
	NeoBundle 'tyru/open-browser.vim'	" ブラウザを起動

#### .vimrc previmの設定
	" previm用の設定(mdファイルをマークダウンとして認識してもらう)
	augroup PrevimSettings
	   autocmd!
	   autocmd BufNewFile,BufRead *.{md,mdwn,mkd,mkdn,mark*} set filetype=markdown
	augroup END
	" F7でプレビュー起動　
	nnoremap <silent> <F7> :PrevimOpen<CR>




unite.vim
--------------------------

### コマンドモードで以下のコマンドを打ち込む
:Unite file     ファイル

### normalモード
C-l キャッシュなどをリフレッシュする。ファイルを追加した場合などに便利

### insertモードでの操作
i(insertモードに入る)でインクリメンタル検索可能になって便利

| キー    | 意味                     |
|---------|--------------------------|
| C-p     | 上に移動                 |
| C-n     | 下に移動                 |
| enter ~ | デフォルトアクション実行 |
| tab     | アクション選択           |

### .vimrcの設定
例えば以下のような設定を行うとノーマルモードで,ufと打ち込むと:Unite fileと打ち込んだことと同じになる
nnoremap <silent> ,uf :<C-u>Unite file<CR>

#### 設定例
```
" filer
nnoremap <silent> ,uf :<C-u>Unite file_rec<CR>
" buffer
nnoremap <silent> ,ub :<C-u>Unite buffer<CR>
" yank
nnoremap <silent> ,uy :<C-u>Unite history/yank<CR>
```


Nerdtree
---------------------------

### 起動方法
:NERDTreeToggleと打ちこむが、面倒なので
以下のキーマップを設定してCtrl-tで起動するようにしている
```
nnoremap <silent><C-t> :NERDTreeToggle<CR>
```


vim-tags
---------------------------

### 前提条件
ctagsがインストールされている必要がある

### 最初にやること
* コマンドラインでプロジェクトルーツに移動し、ctags -f ~/.tags -R . を実行し、tagsファイルを生成する
* vim上でrailsなどのプロジェクトルートで:TagsGenerateと入力する必要がある

### 使い方
| 機能                           | ショートカット |
|--------------------------------|----------------|
| 定義にジャンプ                 | C-]            |
| ジャンプ前に戻る               | C-o            |
| ジャンプ前のジャンプ前に戻る？ | C-i            |


### 使い方
| やりたいこと               | 操作                                                                                       |
|----------------------------|--------------------------------------------------------------------------------------------|
| ファイルを新しいタグで開く | カーソルの上でt                                                                            |
| ファイル新規作成           | 作成したいディレクトリに移動後、mでメニューを開き、a(add)でファイル名を打ち込む            |
| ファイルコピー             | 作成したいディレクトリに移動後、mでメニューを開き、c(copy)でコピー先のファイル名を打ち込む |



taglist
---------------------------
### 使い方
:Tlistで画面左側にメソッドの一覧が表示される



emmit
---------------------------
### 使い方
```
html:5
```
を打ち込んでから<ctrl+y>,と入力

## 個人的なリファレンス


ag.vim
---------------------------
### 使い方
ノーマルモードで****.rbファイル内でorderを含んでいるファイルを検索する
```
:Ag -G '\.rb$' order
```

また、予めAgで定義されているファイル形式を指定して検索することも可能
下はrubyの例
```
:Ag --ruby order .
```
ファイル形式の詳細は[このページを参照](http://qiita.com/umanoda/items/61f972954d99b41d267a)

visSum
---------------------------
### 概要
記述されている数値を読み取って合計を出力するだけのプラグイン

### 使い方
ビジュアルモードで複数行を選択した状態で<Leader>suを押すとステータスラインに計算結果が出力される



vimの設定について
---------------------------

### vimの設定ファイルで設定している意味

| 設定          | 意味                                                                    |
|---------------|-------------------------------------------------------------------------|
| :map          | 全ての時                                                                |
| :noremap      | ユーザーの割り当てとは関係なくmapする場合に使う。通常はこちらを使うこと |
| :imap         | インサートモードの時だけ                                                |
| :nmap         | ノーマルモードの時だけ                                                  |
| :vmap         | ビジュアルモードの時だけ                                                |
| :verbose nmap | 定義元ファイル情報も表示                                                |

#### 簡単な例

以下の設定は全てのモードで「j」を押した時、「k」を押した時と同じになる

```
:map j k
```

テキストオブジェクト(text object)について
---------------------------

## 概要
あるルールに基づいたテキストのまとまりでカーソル位置のテキストについて、操作と範囲などを指定して操作することが可能

## オペレータの基本
オペレータコマンド + (回数指定) + 内部/外部指定 + テキストオブジェクトの種類の指定

## オペレータ

| key   | operation             |
|-------|-----------------------|
| c     | 変更                  |
| d     | 削除                  |
| y     | yank                  |
| ~     | 大文字/小文字入れ替え |
| gu/gU | 全て小文字/大文字     |

## 内部・外部指定

| a | テキストオブジェクト全体を指定。例えば"で囲われていた場合、"を含める   |
| i | テキストオブジェクト内部を指定。例えば"で囲われていた場合、"を含めない |

## テキストオブジェクト

| key   | operation             |
|-------|-----------------------|
| w     | 単語                  |


## よく使うテキストオブジェクト

カーソルの位置にある単語をヤンク  yiw





vimの個人的な設定について
---------------------------

## 編集中のrubyスクリプトを実行

ctrl + e

.vimrc
```
autocmd BufNewFile,BufRead *.rb nnoremap <C-e> :!ruby %<CR>
```


個人的なhow to
---------------------------

## vimを一旦、抜けてターミナルに戻り、復帰する方法

### バックグラウンド（ターミナル）に退避
C-z

### バックグラウンドプロセスの確認
jobs

### バックグラウンドプロセスからvimへ復帰
fg

fg %{jobsで表示される番号}




## 連番を作成

以下のような状態の時、ビジュアルモードで選択後、g<C-a>とすると連番になる
ポイントは選択した数字+1から始まること
ちなみにデクリメントは<C-x>
```
1
1
1
```

実施後
```
1
2
3
```



## ヤンクした文字列を行頭に挿入する

* 何かをヤンクする
* ビジュアルモードで選択後、shift+Iでインサートモードに
* <C-r>"の後にescで直前にヤンクしたものが行頭に挿入される

aaa
aaa11111
aaa11111
aaa11111
aaa11111
aaa11111
aaa11111
aaa11111


## 計算する
insert modeの時、<ctrl-r>=<計算式>
とすると計算結果を出力可能

### 丸め
=round(123.456)

## インデント
visualモードで選択し、>や<でインデントを調整可能

